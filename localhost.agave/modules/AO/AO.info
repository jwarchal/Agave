<?php
/* 
 * Author: Shabnam Tafreshi
 * Date: 07-06-10
 */
function AO_info_meta() {
	return array(
		'name'=>'AO',
		'machine-name'=>'AO',
		'description'=>'Provides an object to create Assessment Objects.',
		'group'=>'AO',
		'version'=>'.1',
		'agave-version'=>'1',
		'dependencies'=>array('user','fieldManager2','themer'),
	);
}

function AO_info_menu() {
	$menus = array();
	//$menus[] = array('Admin','Tasks only available to site administrators can be found in the Admin menu.');

	return $menus;
}

function AO_info_menu_items() {
	$items = array();
	$items[] = array('user','/Item Bank',0,'Item Bank.','AO/view',1,1,'AO_ViewRequest');

	return $items;
}

function AO_info_messages() {
	$msgs = array();
//	$msgs[] = array('type','handle','message');

	return $msgs;

}

function AO_info_panels() {
	$panels = array();
//	$panels[] = array('name','title','content','query','template','func','region','include','exclude','access','weight','enabled?');

	return $panels;
}

function AO_info_system_uri() {
	$uris = array();
//	$uris[] = array('dest','alias','access','function','file','panels','actions','fast_route');
	$uris[] = array('itemBank/%',NULL,'AO_ViewRequest','view','0','1','0');
	$uris[] = array('itemBank/%/version/%', NULL,'AO_ViewRequest','view','0','1','0');
	$uris[] = array('itemBank/%/version/%/edit',NULL,'AO_EditRequest','edit','0','1','0');
	$uris[] = array('itemBank/addObject',NULL,'AO_AddObjectRequest','addObject','0','1','0');
	$uris[] = array('itemBank/%/version/%/save',NULL,'AO_SaveRequest','save', '0','1','0');
	$uris[] = array('itemBank/save',NULL,'AO_SaveRequest','save','0','1','0');
	$uris[] = array('user/itemBank',NULL,'AO_AllAO_Request','user','0','1','0');
	$uris[] = array('itemBank/%/compare/%/%',NULL,'AO_CompareRequest','compare','0','1','0');
	$uris[] = array('itemBank/%/comment/%',NULL,'AO_CommentRequest','comment','0','1','0');
	$uris[] = array('itemBank/%/delete/%/%/%',NULL,'AO_DeleteRequest','delete','0','1','0');
	$uris[] = array('itemBank/addObject/%/%',NULL,'AO_AddObjectRequest','addObject','0','1','0');
	return $uris;
}

function AO_info_system_variables() {
	$vars = array();
//	$vars[] = array('key','PHP value');

	return $vars;

}

function AO_info_user_access() {
	$args = array();
	//$args[] = array('administer_site','Administer Settings','Permits user to manage basic site settings.','0');
	return $args;

}

function AO_info_install() {
	global $agave;
	$query = 'SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO"';
	$agave->doSQLQuery($query, 0);

	//actions
	$query = "CREATE TABLE IF NOT EXISTS `actions` (
	  `eKey` int(11) NOT NULL auto_increment,
	  `name` text character set latin1 NOT NULL,
	  `action` text character set latin1 NOT NULL,
	  `desc` text character set latin1 NOT NULL,
	  `func` varchar(256) collate utf8_unicode_ci NOT NULL,
	  `file` varchar(256) collate utf8_unicode_ci NOT NULL,
	  `module` text character set latin1 NOT NULL,
	  `active` tinyint(1) NOT NULL,
	  PRIMARY KEY  (`eKey`)
	) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

	//cache
	$query = "CREATE TABLE IF NOT EXISTS `cache` (
	  `cacheKey` int(11) NOT NULL auto_increment,
	  `item` varchar(128) collate utf8_unicode_ci NOT NULL,
	  `data` longblob,
	  `created` int(11) NOT NULL,
	  `expires` int(11) NOT NULL COMMENT '\"0\" means the cache does NOT expire',
	  `module` varchar(128) collate utf8_unicode_ci NOT NULL,
	  PRIMARY KEY  (`cacheKey`)
	) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

	//cron
	$query = "CREATE TABLE IF NOT EXISTS `cron` (
	  `id` int(11) NOT NULL auto_increment,
	  `name` varchar(64) collate utf8_unicode_ci default NULL,
	  `description` text collate utf8_unicode_ci,
	  `module` varchar(128) collate utf8_unicode_ci NOT NULL,
	  `function` varchar(128) collate utf8_unicode_ci NOT NULL,
	  `interval` int(11) NOT NULL,
	  `last_run` int(11) default NULL,
	  `enabled` tinyint(1) NOT NULL default '0',
	  PRIMARY KEY  (`id`)
	) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

	//logs
	$query = "CREATE TABLE IF NOT EXISTS `logs` (
	  `key` int(11) NOT NULL auto_increment,
	  `type` text character set utf8 NOT NULL,
	  `event` text character set utf8 NOT NULL,
	  `location` text character set latin1 NOT NULL,
	  `userKey` int(11) default NULL,
	  `time` bigint(20) NOT NULL,
	  PRIMARY KEY  (`key`)
	) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

	//messages
	$query = "CREATE TABLE IF NOT EXISTS `messages` (
	  `messageKey` bigint(20) NOT NULL auto_increment,
	  `type` varchar(12) collate utf8_unicode_ci NOT NULL default 'general',
	  `handle` text character set latin1 NOT NULL,
	  `message` text character set utf8 NOT NULL,
	  `userKey` int(11) default NULL,
	  `time_added` bigint(20) default NULL,
	  `time_start` bigint(20) NOT NULL,
	  `time_expire` bigint(20) NOT NULL,
	  `module` varchar(128) character set latin1 NOT NULL,
	  PRIMARY KEY  (`messageKey`)
	) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

	//system uri
	$query = "CREATE TABLE IF NOT EXISTS `system_uri` (
	  `uriKey` int(11) NOT NULL auto_increment,
	  `dest` text character set latin1 NOT NULL,
	  `alias` text character set latin1 NOT NULL,
	  `access` text character set latin1 NOT NULL,
	  `function` varchar(128) collate utf8_unicode_ci default NULL,
	  `file` varchar(64) character set utf8 NOT NULL,
	  `module` varchar(64) character set utf8 NOT NULL,
	  `panels` tinyint(1) NOT NULL default '1',
	  `actions` tinyint(1) NOT NULL,
	  `fast_route` tinyint(1) NOT NULL default '0',
	  PRIMARY KEY  (`uriKey`)
	) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

	//system variables (settings)
	$query = "CREATE TABLE IF NOT EXISTS `system_variables` (
	  `varKey` int(11) NOT NULL auto_increment,
	  `key` text character set latin1 NOT NULL,
	  `value` text character set latin1 NOT NULL,
	  PRIMARY KEY  (`varKey`)
	) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;";
	$agave->doSQLQuery($query, 0);

}
?>
